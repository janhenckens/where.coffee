{"version":3,"sources":["main.js","ajax.js"],"names":[],"mappings":"AAAA;AACA;AACA;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["$(document).ready(function() {\n\n});","$(document).ready(function() {\n    $('form#query').on('submit', function (e) {\n        e.preventDefault();\n        var $location =  $('input[name=searchlocation]').val();\n        var $request_type = $('input[name=request_type]').val();\n        var url = '/search';\n        $.ajaxSetup({\n            headers: {\n                'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n            }\n        });\n\n        var request = $.ajax({\n            type: 'post',\n            url: url,\n            data: {'searchlocation': $location, 'request_type': $request_type},\n            success:  function(){\n                $('.panel').fadeOut('slow').addClass('hidden');\n            }\n        })\n\n\n        request.done(function(data) {\n            var locations = jQuery.parseJSON(data);\n            $('#map').fadeIn('slow').show();\n            console.log(locations.center.lat);\n            console.log(locations.center.lng);\n            L.mapbox.accessToken = 'pk.eyJ1IjoiamFuaGVuY2tlbnMiLCJhIjoiMzc2NDI5MDE1ZWI5NzZlOTBmZjNmMWQxMTgxNmQ4ZGMifQ.0MzXVdyyPn7Xt5qnmp2KbQ';\n            var map = L.mapbox.map('map', 'janhenckens.i204n3ak').setView([locations.center.lat, locations.center.lng], 15);\n            var myLocation = L.icon({\n                iconSize: [35, 95],\n                popupAnchor: [0,-37],\n                iconUrl: 'http://where.coffee/assets/img/yourlocation.png',\n\n            });\n            $.each(locations.venues, function() {\n                console.log(this.lat);\n                console.log(this.name);\n                var markerContent = '<h2>' + this.name + '</h2>';\n                L.marker([this.lat, this.lng], {\n                    icon: L.mapbox.marker.icon({\n                        'marker-color': '#BE9A6B',\n                        'marker-symbol': 'cafe',\n                        'marker-size': 'large'\n                    })\n                },{\n                    title: this.name,\n                }).addTo(map).bindPopup(markerContent);\n            })\n\n\n\n        });\n    });\n    $('#getlocation').on('click', function(e){\n        e.preventDefault();\n        $('#getlocation').attr(\"disabled\", \"disabled\");\n        navigator.geolocation.getCurrentPosition(success, error);\n    });\n    function success(position) {\n        console.log(\"Location found (2)\");\n        var $lng = position.coords.longitude;\n        var $lat = position.coords.latitude;\n        var $location = $lat + ',' + $lng;\n        var $url = '/search';\n        $.ajaxSetup({\n            headers: {\n                'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n            }\n        });\n\n        $.ajax({\n            type: 'post',\n            url: $url,\n            data: {'lat': $lat, 'lng': $lng, 'searchlocation': $location, 'request_type' : 'geo'},\n            success: function (data) {\n                console.log(data);\n                $('.panel').fadeOut('slow').addClass('hidden');\n\n            }\n        })\n        //var mylocationContent = '<H2>You are here</H2>';\n        //L.marker([locations.center.lat, locations.center.lng], {icon: myLocation}).addTo(map).bindPopup(mylocationContent);\n\n    }\n    function error(position) {\n        console.log('location not found');\n    }\n});\n"],"sourceRoot":"/source/"}